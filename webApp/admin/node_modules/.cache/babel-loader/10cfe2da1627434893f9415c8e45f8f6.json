{"ast":null,"code":"var _jsxFileName = \"/home/iassure/iAssureIT/node_react/wealthyvia/wealthyvia/webApp/admin/src/ImageUpload/ImageUpload.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport swal from 'sweetalert';\nimport S3FileUpload from 'react-s3';\n/**/\n// import \"bootstrap/dist/css/bootstrap.min.css\";\n\nimport './ImageUpload.css';\naxios.defaults.baseURL = 'http://gangaexpressapi.iassureit.com';\naxios.defaults.headers.post['Content-Type'] = 'application/json';\nvar imgArray = [];\nvar imgTitleArray = [];\n\nclass ImageUpload extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      \"config\": '',\n      \"imageArray\": [],\n      \"imageTitleArray\": [],\n      \"S3url\": []\n    };\n  }\n\n  uploadImage(event) {\n    var imageTitleArray = this.state.imageTitleArray;\n    var video = this.state.video;\n    var uid = localStorage.getItem(\"uid\");\n    var propertyId = localStorage.getItem(\"propertyId\");\n    main().then(formValues => {\n      console.log(\"3 formValues = \", formValues);\n      axios.patch('/api/products/patch/gallery', formValues).then(res => {\n        console.log(\"response = \", res);\n\n        if (res.status === 200) {\n          console.log(\"res = \", res);\n        }\n      }).catch(error => {\n        console.log(\"error = \", error);\n      });\n    });\n\n    async function main() {\n      var config = await getConfig();\n      var s3urlArray = [];\n\n      for (var i = 0; i < imageTitleArray.length; i++) {\n        var s3url = await s3upload(imageTitleArray[i].fileInfo, config, this);\n        s3urlArray.push(s3url);\n      } // var videoUrl = await s3uploadVideo(video, config, this);\n\n\n      const formValues = {\n        \"product_ID\": '5d448d521442c93c4cec1f03',\n        // \"uid\" \t\t  \t\t: uid,\n        \"productImage\": s3urlArray,\n        // \"video\"\t\t\t\t: videoUrl,\n        \"status\": \"New\"\n      };\n      console.log(\"1 formValues = \", formValues);\n      return Promise.resolve(formValues);\n    }\n\n    function s3upload(image, configuration) {\n      return new Promise(function (resolve, reject) {\n        S3FileUpload.uploadFile(image, configuration).then(Data => {\n          // console.log(\"Data = \",Data);\n          resolve(Data.location);\n        }).catch(error => {\n          console.log(error);\n        });\n      });\n    }\n\n    function s3uploadVideo(video, configuration) {\n      return new Promise(function (resolve, reject) {\n        S3FileUpload.uploadFile(video, configuration).then(Data => {\n          // console.log(\"Data = \",Data);\n          resolve(Data.location);\n        }).catch(error => {\n          console.log(error);\n        });\n      });\n    }\n\n    function getConfig() {\n      return new Promise(function (resolve, reject) {\n        axios.get('/api/projectSettings/get/one/S3').then(response => {\n          console.log(\"proj set res = \", response.data);\n          const config = {\n            bucketName: response.data.bucket,\n            dirName: 'propertiesImages',\n            region: response.data.region,\n            accessKeyId: response.data.key,\n            secretAccessKey: response.data.secret\n          };\n          resolve(config);\n        }).catch(function (error) {\n          console.log(error);\n        });\n      });\n    }\n  }\n\n  backToAvailability() {\n    this.props.backToAvailability();\n  }\n\n  handleImgChange(event) {\n    if (event.currentTarget.files && event.currentTarget.files[0]) {\n      for (var i = 0; i < event.currentTarget.files.length; i++) {\n        var file = event.currentTarget.files[i];\n\n        if (file) {\n          var fileName = file.name;\n          var ext = fileName.split('.').pop();\n\n          if (ext === \"jpg\" || ext === \"png\" || ext === \"jpeg\" || ext === \"JPG\" || ext === \"PNG\" || ext === \"JPEG\") {\n            if (file) {\n              var objTitle = {\n                fileInfo: file\n              };\n              imgTitleArray.push(objTitle); // var reader = new FileReader();\n              // reader.onloadend = () => {\n              //    \tvar obj={\n              // \t   \timgPath : reader.result,\n              // \t}\n              // \timgArray.push(obj);\n              //    \tthis.setState(prevState => ({\n              //    \t\timageArray : [...this.prevState.imageArray, imgArray]\n              //    \t}))\n              // }\n              //   \treader.readAsDataURL(file)\n            } else {\n              swal(\"Images not uploaded\", \"Something went wrong\", \"error\");\n            } //file\n\n          } else {\n            swal(\"Please upload Image\", \"Allowed images formats are (jpg,png,jpeg)\", \"warning\");\n          } //file types\n\n        } //file\n\n      } //for \n\n\n      if (i >= event.currentTarget.files.length) {\n        this.setState({\n          imageTitleArray: imgTitleArray\n        }, () => {\n          console.log('imageTitleArray', this.state.imageTitleArray);\n        });\n      }\n    }\n  }\n\n  handleVideoChange(event) {\n    if (event.currentTarget.files && event.currentTarget.files[0]) {\n      var file = event.currentTarget.files[0];\n\n      if (file) {\n        var fileName = file.name;\n        var ext = fileName.split('.').pop();\n\n        if (ext === \"mp4\" || ext === \"avi\" || ext === \"ogv\") {\n          if (file) {\n            this.setState({\n              video: {\n                fileInfo: file\n              }\n            });\n            console.log(\"video = \", file);\n          } else {\n            swal(\"Video not uploaded\", \"Something went wrong\", \"error\");\n          } //file\n\n        } else {\n          swal(\"Please upload Correct Video\", \"Allowed Formats are .mp4, .avi, .ogv\", \"warning\");\n        } //file types\n\n      } //file\n\n    }\n  }\n\n  deleteimage(e) {\n    // var arry = this.state.imageTitleArray\n    var array = [...this.state.imageTitleArray]; // make a separate copy of the array\n\n    var index = array.indexOf(e.target.value);\n\n    if (index !== -1) {\n      array.splice(index, 1);\n      this.setState({\n        imageTitleArray: array\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-10  col-lg-offset-1 col-md-12 col-sm-12 col-xs-12 backGround\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 contentHolder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 uploadImg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, \"Please Upload Images:\"), React.createElement(\"input\", {\n      type: \"file\",\n      className: \"\",\n      accept: \".jpg,.jpeg,.png\",\n      onChange: this.handleImgChange.bind(this),\n      multiple: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-lg-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, this.state.imageArray ? this.state.imageArray.map((data, index) => {\n      return React.createElement(\"div\", {\n        className: \"col-lg-4 imgcss\",\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        style: {\n          width: \"150px\"\n        },\n        className: \"img-responsive\",\n        src: data.imgPath,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"imgLabel\",\n        id: index,\n        handleVideoChange: true,\n        onClick: this.deleteimage.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, \"\\xD7\"));\n    }) : null), React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 uploadVideo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, \"Please Upload Video:\"), React.createElement(\"input\", {\n      type: \"file\",\n      className: \"\",\n      accept: \".mp4, .avi, .ogv\",\n      onChange: this.handleVideoChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 mt78\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group col-lg-3\\tcol-md-3 col-sm-4 col-xs-4 pull-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn nxt_btn col-lg-12 col-md-12 col-sm-12 col-xs-12\",\n      onClick: this.uploadImage.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, \"Finish \\xA0 \\xA0 \\u21D2\"))));\n  }\n\n} // const mapStateToProps = (state)=>{\n// \treturn {\n// \t\tproperty_id  : state.property_id,\n// \t\tuid\t\t\t : state.uid\n// \t}\n// };\n// const mapDispatchToProps = (dispatch)=>{\n// \treturn {\n// \t\tbackToAvailability  \t     : ()=> dispatch({type: \"BACK_TO_AVAILABILITY\"}),\n// \t\tredirectToCongratsPage \t\t : (uid,propertyId)=> dispatch({type: \"REDIRECT_TO_CONGRATS_PAGE\",\n// \t\t\t\t\t\t\t\t\t\t\t uid         :  uid,\n// \t\t\t\t\t\t\t\t\t\t\t property_id :  propertyId,\t\n// \t\t\t\t\t\t\t\t}),\n// \t}\n// };\n// export default connect(mapStateToProps,mapDispatchToProps)(withRouter(ImageUpload));\n\n\nexport default withRouter(ImageUpload);","map":{"version":3,"sources":["/home/iassure/iAssureIT/node_react/wealthyvia/wealthyvia/webApp/admin/src/ImageUpload/ImageUpload.js"],"names":["React","Component","axios","connect","withRouter","swal","S3FileUpload","defaults","baseURL","headers","post","imgArray","imgTitleArray","ImageUpload","constructor","props","state","uploadImage","event","imageTitleArray","video","uid","localStorage","getItem","propertyId","main","then","formValues","console","log","patch","res","status","catch","error","config","getConfig","s3urlArray","i","length","s3url","s3upload","fileInfo","push","Promise","resolve","image","configuration","reject","uploadFile","Data","location","s3uploadVideo","get","response","data","bucketName","bucket","dirName","region","accessKeyId","key","secretAccessKey","secret","backToAvailability","handleImgChange","currentTarget","files","file","fileName","name","ext","split","pop","objTitle","setState","handleVideoChange","deleteimage","e","array","index","indexOf","target","value","splice","render","bind","imageArray","map","width","imgPath"],"mappings":"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","sourcesContent":["import React , { Component }\tfrom 'react';\nimport axios \t\t\t\t\tfrom 'axios';\nimport { connect } \t\t\t\tfrom 'react-redux';\nimport { withRouter}            from 'react-router-dom';\nimport swal \t\t\t\t\tfrom 'sweetalert';\nimport S3FileUpload \t\t\tfrom 'react-s3';\n/**/\n// import \"bootstrap/dist/css/bootstrap.min.css\";\nimport './ImageUpload.css';\n\naxios.defaults.baseURL = 'http://gangaexpressapi.iassureit.com';\naxios.defaults.headers.post['Content-Type'] = 'application/json';\n\n\nvar imgArray = [];\nvar imgTitleArray = [];\n class ImageUpload extends Component {\n\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\t\"config\"\t\t\t: '',\n\t\t\t\"imageArray\"  \t\t: [],\n\t\t\t\"imageTitleArray\" \t: [],\n\t\t\t\"S3url\" \t        : [],\n\t\t}\n\n\n\t}\n\t\n\tuploadImage(event){\n\t\tvar imageTitleArray = this.state.imageTitleArray;\n\t\tvar video \t\t\t= this.state.video;\n\t\tvar uid \t\t\t= localStorage.getItem(\"uid\");\n\t\tvar propertyId \t\t= localStorage.getItem(\"propertyId\");\n\t\t\n\t\t\n\t\tmain().then(formValues => {\n\t\t\tconsole.log(\"3 formValues = \",formValues);\n\n\t\t\taxios.patch('/api/products/patch/gallery',formValues)\n\t\t\t.then( (res) =>{\n\t\t\t\tconsole.log(\"response = \", res);\n\t\t\t\tif(res.status === 200){\n\t\t\t\t\tconsole.log(\"res = \", res);\n\t\t\t\t}\n\n\t\t\t})\n\t\t\t.catch((error) =>{\n\t\t\t\tconsole.log(\"error = \", error);\n\t\t\t});\t\t\n\t\t});\n\n\n\n\t\tasync function main(){\n\t\t\tvar config = await getConfig();\n\t\t\t\n\t\t\tvar s3urlArray = [];\n\t\t\tfor (var i = 0; i<imageTitleArray.length; i++) {\n\t\t\t\tvar s3url = await s3upload(imageTitleArray[i].fileInfo, config, this);\n\t\t\t\ts3urlArray.push(s3url);\n\t\t\t}\n\n\t\t\t// var videoUrl = await s3uploadVideo(video, config, this);\n\n\t\t\tconst formValues = {\n\t\t\t\t\"product_ID\" \t\t: '5d448d521442c93c4cec1f03',\n\t\t\t\t// \"uid\" \t\t  \t\t: uid,\n\t\t\t\t\"productImage\"\t\t: s3urlArray,\n\t\t\t\t// \"video\"\t\t\t\t: videoUrl,\n\t\t\t\t\"status\"\t\t\t: \"New\"\n\t\t\t};\n\n\t\t\tconsole.log(\"1 formValues = \",formValues);\n\t\t\treturn Promise.resolve(formValues);\n\t\t}\n\n\n\t\tfunction s3upload(image,configuration){\n\n\t\t\treturn new Promise(function(resolve,reject){\n\t\t\t\tS3FileUpload\n\t\t\t\t   .uploadFile(image,configuration)\n\t\t\t\t   .then((Data)=>{\n\t\t\t\t   \t\t// console.log(\"Data = \",Data);\n\t\t\t\t   \t\tresolve(Data.location);\n\t\t\t\t   })\n\t\t\t\t   .catch((error)=>{\n\t\t\t\t   \t\tconsole.log(error);\n\t\t\t\t   })\n\t\t\t})\n\t\t}\n\n\t\tfunction s3uploadVideo(video,configuration){\n\n\t\t\treturn new Promise(function(resolve,reject){\n\t\t\t\tS3FileUpload\n\t\t\t\t   .uploadFile(video,configuration)\n\t\t\t\t   .then((Data)=>{\n\t\t\t\t   \t\t// console.log(\"Data = \",Data);\n\t\t\t\t   \t\tresolve(Data.location);\n\t\t\t\t   })\n\t\t\t\t   .catch((error)=>{\n\t\t\t\t   \t\tconsole.log(error);\n\t\t\t\t   })\n\t\t\t})\n\t\t}\n\n\n\n\t\tfunction getConfig(){\n\t\t\treturn new Promise(function(resolve,reject){\n\t\t\t\taxios\n\t\t\t       .get('/api/projectSettings/get/one/S3')\n\t\t\t       .then((response)=>{\n\t\t\t       \t\tconsole.log(\"proj set res = \",response.data);\n\t\t\t\t\t\tconst config = {\n\t\t\t\t\t\t\tbucketName \t\t: response.data.bucket,\n\t\t\t\t\t\t\tdirName  \t\t: 'propertiesImages',\n\t\t\t\t\t\t\tregion \t\t\t: response.data.region,\n\t\t\t\t\t\t\taccessKeyId \t: response.data.key,\n\t\t\t\t\t\t\tsecretAccessKey : response.data.secret,\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(config);\t\t\t\t\t\t   \n\t\t\t\t\t})\n\t\t\t       .catch(function(error){\n\t\t\t         \tconsole.log(error);\n\t\t\t       })\n\n\t\t\t})\n\t\t}\n\n\t}\n\n\tbackToAvailability(){\n\t\tthis.props.backToAvailability();\n\t}\n\n\thandleImgChange(event){\n\t   \tif (event.currentTarget.files && event.currentTarget.files[0]) {\n\t   \t\tfor(var i=0; i<event.currentTarget.files.length; i++){\n\t\t\t   \tvar file = event.currentTarget.files[i];\n\t\t     \tif (file) {\n\t\t     \t  \tvar fileName  = file.name; \n\t\t     \t    var ext = fileName.split('.').pop();  \n\t\t            if(ext===\"jpg\" || ext===\"png\" || ext===\"jpeg\" || ext===\"JPG\" || ext===\"PNG\" || ext===\"JPEG\"){\n\t\t                if (file) {\n\t                       \tvar objTitle = { fileInfo :file }\n\t\t\t\t\t\t\timgTitleArray.push(objTitle);\n\t\t\t\t\t\t\t// var reader = new FileReader();\n\t\t\t\t\t\t\t// reader.onloadend = () => {\n\t\t\t\t\t\t \t//    \tvar obj={\n\t\t\t\t\t\t\t// \t   \timgPath : reader.result,\n\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t// \timgArray.push(obj);\n\t\t\t\t\t\t\t//    \tthis.setState(prevState => ({\n\t\t\t\t\t\t\t//    \t\timageArray : [...this.prevState.imageArray, imgArray]\n\t\t\t\t\t\t\t//    \t}))\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t  //   \treader.readAsDataURL(file)\n\t\t    \t\t\t}else{          \n\t\t\t\t\t\t    swal(\"Images not uploaded\",\"Something went wrong\",\"error\");  \n\t\t\t\t        }//file\n\t\t            }else{ \n\t\t                swal(\"Please upload Image\",\"Allowed images formats are (jpg,png,jpeg)\",\"warning\");   \n\t\t            }//file types\n\t\t   \t\t}//file\n\n\t   \t\t}//for \n\n\t   \t\tif(i >= event.currentTarget.files.length){\n\t\t\t\tthis.setState({\n\t\t\t\t   \timageTitleArray : imgTitleArray\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.log('imageTitleArray', this.state.imageTitleArray)\n\t\t\t\t});\t   \t\t\t\n\t   \t\t}\n\n\t\t}\n\t}\n\n\thandleVideoChange(event){\n\t   \tif (event.currentTarget.files && event.currentTarget.files[0]) {\n\t\t   \tvar file = event.currentTarget.files[0];\n\t     \tif (file) {\n\t     \t  \tvar fileName  = file.name; \n\t     \t    var ext = fileName.split('.').pop();  \n\t            if(ext===\"mp4\" || ext===\"avi\" || ext===\"ogv\"){\n\t                if (file) {\n\t                \tthis.setState({\n\t                \t\tvideo : { fileInfo : file }\n\t                \t});\n\t                \tconsole.log(\"video = \", file);\n\t    \t\t\t}else{          \n\t\t\t\t\t    swal(\"Video not uploaded\",\"Something went wrong\",\"error\");  \n\t\t\t        }//file\n\t            }else{ \n\t                swal(\"Please upload Correct Video\",\"Allowed Formats are .mp4, .avi, .ogv\",\"warning\");   \n\t            }//file types\n\t   \t\t}//file\n\t\t}\n\t}\n\n\tdeleteimage(e){\n\t\t// var arry = this.state.imageTitleArray\n\t\tvar array = [...this.state.imageTitleArray]; // make a separate copy of the array\n\t  \tvar index = array.indexOf(e.target.value)\n\t\tif (index !== -1) {\n\t\t   array.splice(index, 1);\n\t\t   this.setState({imageTitleArray: array});\n\t\t}\n\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 \">\n\t\t\t\t<div className=\"col-lg-10  col-lg-offset-1 col-md-12 col-sm-12 col-xs-12 backGround\">\n\t\t\t\t\t<div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 contentHolder\">\n\t\t\t\t\t\t<div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 uploadImg\">\n\t\t\t\t\t\t\t<label>Please Upload Images:</label>\n\t\t\t\t\t\t\t<input type=\"file\" className=\"\" accept=\".jpg,.jpeg,.png\" onChange={this.handleImgChange.bind(this)} multiple/>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"col-lg-12\">\n\t\t\t\t\t\t\t{this.state.imageArray?\n\t\t\t\t\t\t\t\tthis.state.imageArray.map((data,index)=>{\n\t\t\t\t\t\t\t\t\treturn(\n\t\t\t\t\t\t\t\t\t\t<div className=\"col-lg-4 imgcss\" key={index}>\n\t\t\t\t\t\t\t\t\t\t\t<img style={{width:\"150px\"}} className=\"img-responsive\" src={data.imgPath}/>\n\t\t\t\t\t\t\t\t\t\t\t<label className=\"imgLabel\" id={index} handleVideoChange  onClick={this.deleteimage.bind(this)}>&times;</label>\n\t\t\t\t\t\t\t\t\t\t</div>)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 uploadVideo\">\n\t\t\t\t\t\t\t<label>Please Upload Video:</label>\n\t\t\t\t\t\t\t<input type=\"file\" className=\"\" accept=\".mp4, .avi, .ogv\" onChange={this.handleVideoChange.bind(this)} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 mt78\">\n\t\t\t\t  \t{/*<div className=\"form-group col-lg-3\tcol-md-3 col-sm-4 col-xs-4 pull-left\">\n\t\t\t\t       <button className=\"btn btn-danger col-lg-12 col-md-12 col-sm-12 col-xs-12\" onClick={this.backToAvailability.bind(this)}> &lArr; &nbsp; &nbsp; Back </button>\n\t\t\t\t  \t</div>*/}\n\t\t\t\t  \t<div className=\"form-group col-lg-3\tcol-md-3 col-sm-4 col-xs-4 pull-right\">\n\t\t\t\t       <button className=\"btn nxt_btn col-lg-12 col-md-12 col-sm-12 col-xs-12\" onClick={this.uploadImage.bind(this)} >Finish &nbsp; &nbsp; &rArr;</button>\n\t\t\t\t  \t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n// const mapStateToProps = (state)=>{\n// \treturn {\n// \t\tproperty_id  : state.property_id,\n// \t\tuid\t\t\t : state.uid\n\n// \t}\n// };\n// const mapDispatchToProps = (dispatch)=>{\n// \treturn {\n// \t\tbackToAvailability  \t     : ()=> dispatch({type: \"BACK_TO_AVAILABILITY\"}),\n// \t\tredirectToCongratsPage \t\t : (uid,propertyId)=> dispatch({type: \"REDIRECT_TO_CONGRATS_PAGE\",\n// \t\t\t\t\t\t\t\t\t\t\t uid         :  uid,\n// \t\t\t\t\t\t\t\t\t\t\t property_id :  propertyId,\t\n// \t\t\t\t\t\t\t\t}),\n\n\n// \t}\n// };\n\n// export default connect(mapStateToProps,mapDispatchToProps)(withRouter(ImageUpload));\nexport default withRouter(ImageUpload);\n"]},"metadata":{},"sourceType":"module"}